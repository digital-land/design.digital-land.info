{% extends "layouts/layout.html" %}
{%- from 'govuk_frontend_jinja/components/table/macro.html' import govukTable -%}
{%- from 'govuk_frontend_jinja/components/tag/macro.html' import govukTag -%}
{% block pageTitle %}Feedback{% endblock %}
{% block content %}
  <main id="content" role="main">
    {% set lpas = [
      "County Durham",
      "Darlington",
      "Hartlepool",
      "Middlesbrough",
      "Northumberland",
      "Redcar and Cleveland",
      "Stockton-on-Tees",
      "Gateshead",
      "Newcastle upon Tyne",
      "North Tyneside",
      "South Tyneside",
      "Sunderland",
      "Blackburn with Darwen",
      "Blackpool",
      "Cheshire East",
      "Cheshire West and Chester",
      "Halton",
      "Warrington",
      "Allerdale",
      "Barrow-in-Furness",
      "Carlisle",
      "Copeland",
      "Eden",
      "South Lakeland",
      "Bolton",
      "Bury",
      "Manchester",
      "Oldham",
      "Rochdale",
      "Salford",
      "Stockport",
      "Tameside",
      "Trafford",
      "Wigan",
      "Burnley",
      "Chorley",
      "Fylde",
      "Hyndburn",
      "Lancaster",
      "Pendle",
      "Preston",
      "Ribble Valley",
      "Rossendale",
      "South Ribble",
      "West Lancashire",
      "Wyre",
      "Knowsley",
      "Liverpool",
      "Sefton",
      "St. Helens",
      "Wirral",
      "East Riding of Yorkshire",
      "Kingston upon Hull, City of",
      "North East Lincolnshire",
      "North Lincolnshire",
      "York",
      "Craven",
      "Hambleton",
      "Harrogate",
      "Richmondshire",
      "Ryedale",
      "Scarborough",
      "Selby",
      "Barnsley",
      "Doncaster",
      "Rotherham",
      "Sheffield",
      "Bradford",
      "Calderdale",
      "Kirklees",
      "Leeds",
      "Wakefield",
      "Derby",
      "Leicester",
      "Nottingham",
      "Rutland",
      "Amber Valley",
      "Bolsover",
      "Chesterfield",
      "Derbyshire Dales",
      "Erewash",
      "High Peak",
      "North East Derbyshire",
      "South Derbyshire",
      "Blaby",
      "Charnwood",
      "Harborough",
      "Hinckley and Bosworth",
      "Melton",
      "North West Leicestershire",
      "Oadby and Wigston",
      "Boston",
      "East Lindsey",
      "Lincoln",
      "North Kesteven",
      "South Holland",
      "South Kesteven",
      "West Lindsey",
      "Corby",
      "Daventry",
      "East Northamptonshire",
      "Kettering",
      "Northampton",
      "South Northamptonshire",
      "Wellingborough",
      "Ashfield",
      "Bassetlaw",
      "Broxtowe",
      "Gedling",
      "Mansfield",
      "Newark and Sherwood",
      "Rushcliffe",
      "Herefordshire, County of",
      "Shropshire",
      "Stoke-on-Trent",
      "Telford and Wrekin",
      "Cannock Chase",
      "East Staffordshire",
      "Lichfield",
      "Newcastle-under-Lyme",
      "South Staffordshire",
      "Stafford",
      "Staffordshire Moorlands",
      "Tamworth",
      "North Warwickshire",
      "Nuneaton and Bedworth",
      "Rugby",
      "Stratford-on-Avon",
      "Warwick",
      "Birmingham",
      "Coventry",
      "Dudley",
      "Sandwell",
      "Solihull",
      "Walsall",
      "Wolverhampton",
      "Bromsgrove",
      "Malvern Hills",
      "Redditch",
      "Worcester",
      "Wychavon",
      "Wyre Forest",
      "Bedford",
      "Central Bedfordshire",
      "Luton",
      "Peterborough",
      "Southend-on-Sea",
      "Thurrock",
      "Cambridge",
      "East Cambridgeshire",
      "Fenland",
      "Huntingdonshire",
      "South Cambridgeshire",
      "Basildon",
      "Braintree",
      "Brentwood",
      "Castle Point",
      "Chelmsford",
      "Colchester",
      "Epping Forest",
      "Harlow",
      "Maldon",
      "Rochford",
      "Tendring",
      "Uttlesford",
      "Broxbourne",
      "Dacorum",
      "East Hertfordshire",
      "Hertsmere",
      "North Hertfordshire",
      "St Albans",
      "Stevenage",
      "Three Rivers",
      "Watford",
      "Welwyn Hatfield",
      "Breckland",
      "Broadland",
      "Great Yarmouth",
      "Kingâ€™s Lynn and West Norfolk",
      "North Norfolk",
      "Norwich",
      "South Norfolk",
      "Babergh",
      "East Suffolk",
      "Ipswich",
      "Mid Suffolk",
      "West Suffolk",
      "Camden",
      "City of London",
      "Hackney",
      "Hammersmith and Fulham",
      "Haringey",
      "Islington",
      "Kensington and Chelsea",
      "Lambeth",
      "Lewisham",
      "Newham",
      "Southwark",
      "Tower Hamlets",
      "Wandsworth",
      "Westminster",
      "Barking and Dagenham",
      "Barnet",
      "Bexley",
      "Brent",
      "Bromley",
      "Croydon",
      "Ealing",
      "Enfield",
      "Greenwich",
      "Harrow",
      "Havering",
      "Hillingdon",
      "Hounslow",
      "Kingston upon Thames",
      "Merton",
      "Redbridge",
      "Richmond upon Thames",
      "Sutton",
      "Waltham Forest",
      "Bracknell Forest",
      "Brighton and Hove",
      "Isle of Wight",
      "Medway",
      "Milton Keynes",
      "Portsmouth",
      "Reading",
      "Slough",
      "Southampton",
      "West Berkshire",
      "Windsor and Maidenhead",
      "Wokingham",
      "Aylesbury Vale",
      "Chiltern",
      "South Bucks",
      "Wycombe",
      "Eastbourne",
      "Hastings",
      "Lewes",
      "Rother",
      "Wealden",
      "Basingstoke and Deane",
      "East Hampshire",
      "Eastleigh",
      "Fareham",
      "Gosport",
      "Hart",
      "Havant",
      "New Forest",
      "Rushmoor",
      "Test Valley",
      "Winchester",
      "Ashford",
      "Canterbury",
      "Dartford",
      "Dover",
      "Folkestone and Hythe",
      "Gravesham",
      "Maidstone",
      "Sevenoaks",
      "Swale",
      "Thanet",
      "Tonbridge and Malling",
      "Tunbridge Wells",
      "Cherwell",
      "Oxford",
      "South Oxfordshire",
      "Vale of White Horse",
      "West Oxfordshire",
      "Elmbridge",
      "Epsom and Ewell",
      "Guildford",
      "Mole Valley",
      "Reigate and Banstead",
      "Runnymede",
      "Spelthorne",
      "Surrey Heath",
      "Tandridge",
      "Waverley",
      "Woking",
      "Adur",
      "Arun",
      "Chichester",
      "Crawley",
      "Horsham",
      "Mid Sussex",
      "Worthing",
      "Bath and North East Somerset",
      "Bournemouth, Christchurch and Poole",
      "Bristol, City of",
      "Cornwall",
      "Dorset",
      "Isles of Scilly",
      "North Somerset",
      "Plymouth",
      "South Gloucestershire",
      "Swindon",
      "Torbay",
      "Wiltshire",
      "East Devon",
      "Exeter",
      "Mid Devon",
      "North Devon",
      "South Hams",
      "Teignbridge",
      "Torridge",
      "West Devon",
      "Cheltenham",
      "Cotswold",
      "Forest of Dean",
      "Gloucester",
      "Stroud",
      "Tewkesbury",
      "Mendip",
      "Sedgemoor",
      "Somerset West and Taunton",
      "South Somerset",
      "Dartmoor National Park",
      "Exmoor National Park",
      "Lake District National Park",
      "New Forest National Park",
      "North York Moors National Park",
      "Northumberland National Park",
      "Peak District National Park",
      "South Downs National Park",
      "The Broads Authority",
      "Yorkshire Dales National Park",
      "Ebbsfleet Development Corporation",
      "London Legacy Development Corporation",
      "Old Oak and Park Royal Development Corporation",
      "Buckinghamshire",
      "North Northamptonshire",
      "West Northamptonshire" 
  ] %}
    
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <div class="govuk-caption-xl">Feedback</div>
        <h1 class="govuk-heading-xl govuk-!-margin-bottom-5">Publishing your planning and housing data</h1>
        <p class="govuk-body-l govuk-!-margin-bottom-6">Get feedback and support to publish data that meets data standards by The Department for Levelling Up, Housing and Communities.</p>
      </div>
    </div>

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
        {# <h1 class="govuk-heading-m govuk-!-margin-bottom-3">Local Planning Authorities</h1> #}
        {# <p class="govuk-body govuk-!-margin-bottom-6">The organisations listed below publish planning and housing data</p> #}
      </div>
      <div class="govuk-grid-column-two-thirds">
        <form class="govuk-!-margin-bottom-6">
          <label class="govuk-label govuk-label--m govuk-!-font-weight-bold" for="filter-organisations-list">Search for a data publisher</label>
          <input class="govuk-input" type="text" id="filter-organisations-list" placeholder="For example, Lambeth">
        </form>      
      </div>
      <div class="govuk-grid-column-full">
        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
      </div>
    </div>
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
        {% set letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" | list %}
        {% for char in letters %}
          {% set theseLPAs = lpas | get_items_beginning_with(char) %}
          <div class="govuk-grid-row js-filter-item">
            <div class="govuk-grid-column-one-third">
              <h2 class="govuk-heading-xl">{{ char }}</h2>
            </div>         
            <div class="govuk-grid-column-two-thirds">
              {% if (theseLPAs | length) > 0 %}
              <ul class="govuk-list govuk-!-margin-bottom-0">
                {% for lpa in theseLPAs | sort %}
                  <li class="govuk-!-margin-bottom-1 js-filter-item">
                    <a href="/{{ lpa | lower | replace(' ', '-') | replace('.','') | replace(',','') | replace("'","") }}" class="govuk-link">{{ lpa }}</a>
                  </li>
                {% endfor %}
              </ul>
            {% else %}
              <p class="govuk-hint">No organisations</p>
            {% endif %}
            </div>
            <div class="govuk-grid-column-full">
              <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
            </div>
          </div>
          <!-- /.govuk-grid-row -->
        {% endfor %}
      </div>
    </div>    

  </main>
{% endblock %}

{% block bodyEnd %}
  <script>
    let filterItems = document.querySelectorAll('.js-filter-item')
    function liveSearch() {
        let search_query = document.getElementById("filter-organisations-list").value;
        
        //Use innerText if all contents are visible
        //Use textContent for including hidden elements
        for (var i = 0; i < filterItems.length; i++) {
            if(filterItems[i].textContent.toLowerCase()
                    .includes(search_query.toLowerCase())) {
                filterItems[i].classList.remove("govuk-visually-hidden");
            } else {
                filterItems[i].classList.add("govuk-visually-hidden");
            }
        }
    }
    //A little delay
    let typingTimer;               
    let typeInterval = 500;  
    let searchInput = document.getElementById('filter-organisations-list');
    searchInput.addEventListener('keyup', () => {
        clearTimeout(typingTimer);
        typingTimer = setTimeout(liveSearch, typeInterval);
    });
  </script>
  {{ super() }}
{% endblock bodyEnd %}
